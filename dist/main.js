/*! /main 1.0.3 | https://github.com/dlueth/qoopido.rescale | (c) 2016 Dirk Lueth */
!function(t,e,i,n){"use strict";function r(i,n,r,l,o){function a(){for(var t,e=0;t=f[e];e++)u.call(t)}function u(){for(var e,i,n,r,l,o=this,a=p[o.uuid],u=o.getParent(),c=0;e=a.candidates[c];c++)if((!e.mql||e.mql.matches)&&(!e.selector||s.call(o,e.selector)))return i=a.image,a.visible&&(n=i.element.getBoundingClientRect(),r=a.settings.modifier({width:n.width,height:n.width*(e.ratio||a.ratio||u.offsetHeight/u.offsetWidth),scale:100*(t.devicePixelRatio||1)}),l=e.url.replace(A,"$1."+Math.round(r.width)+"x"+Math.round(r.height)+"@"+Math.round(r.scale)+".$2"),i.setAttribute("src",l)),void d.call(o,e.ratio);d.call(o)}function s(t){var i,n,r,l=this,o=e.querySelectorAll(t);if(o.length)for(i=l.element,n=0;r=o[n];n++)if(r===i)return!0;return l.getParent(t)}function c(){for(var t,e,i,n,l,o=this,a=o.getChildren('[itemprop="contentUrl"]'),s=[],c=0;t=a[c];c++)e=(e=t.getAttribute("width"))?parseInt(e):null,i=(i=t.getAttribute("height"))?parseInt(i):null,n=e&&i?i/e:null,l=(l=t.getAttribute("media"))?new r(l).on("match unmatch",function(){u.call(o)}):null,s.push({url:t.getAttribute("content"),ratio:n,mql:l,selector:t.getAttribute("selector")});return s}function d(t){var e=this,i=e.getParent(),n=p[e.uuid];return n.container.setStyle("paddingBottom",100*(t||n.ratio||i.offsetHeight/i.offsetWidth)+"%"),e}function h(t,e){var r,o,a,s,h,A,b,v=n.prototype.constructor.call(this,t,e),w=v.uuid;return o=new i("<div />").setStyles({position:"relative",display:"block",width:"100%",height:0,padding:0}).appendTo(v),a=(r=v.getChildren('[itemprop="width"]')[0])?parseInt(r.getAttribute("content")):null,s=(r=v.getChildren('[itemprop="height"]')[0])?parseInt(r.getAttribute("content")):null,h=(r=v.getChildren('[itemprop="caption"]')[0])?r.getAttribute("content"):null,A=new i("<img />",{src:m,alt:h||""},{position:"absolute",display:"block",width:"100%",height:"100%",top:"0",left:"0",margin:"0",padding:"0"}).appendTo(o),b=p[w]={visible:!1,settings:l({},g.settings,e),ratio:a&&s?s/a:null,container:o,image:A,candidates:c.call(v),caption:h},f.push(v),d.call(v).on("appear disappear",function(t){b.visible="appear"===t.type,b.visible||A.setAttribute("src",m),u.call(v)})}var g,p={},f=[],A=/(.+?).(jpe?g|png|gif)$/,m="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=";return new i(t).on("resize orientationchange",o(a)),g=n.extend(h),g.settings={modifier:function(t){return t.scale=Math.min(200,t.scale),t}},g}n(["/nucleus/dom/element","/nucleus/dom/element/appear","/nucleus/component/sense","/nucleus/function/merge","/nucleus/function/debounce"],r)}(this,document,demand,provide);
//# sourceMappingURL=main.js.map
