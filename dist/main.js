/*! /main 1.0.7 | https://github.com/dlueth/qoopido.rescale | (c) 2016 Dirk Lueth */
!function(t,e,i,n){"use strict";function r(i,n,r,l,a){function o(){for(var t,e=0;t=f[e];e++)u.call(t)}function u(){for(var e,i,n,r,l,a,o=this,u=p[o.uuid],s=o.getParent(),g=0;e=u.candidates[g];g++)if((!e.mql||e.mql.matches)&&(!e.selector||c.call(o,e.selector)))return i=u.image,u.visible&&(n=i.element.getBoundingClientRect(),r=u.settings.modifier({width:n.width,height:n.width*(e.ratio||u.ratio||s.offsetHeight/s.offsetWidth),scale:100*(t.devicePixelRatio||1)}),l=e.quality||u.quality,a=e.url.replace(A,"$1."+Math.round(r.width)+"x"+Math.round(r.height)+"@"+Math.round(r.scale)+(l?"."+l:"")+".$2"),i.setAttribute("src",a).emit("rescale",e.url,a)),void d.call(o,e.ratio);d.call(o)}function c(t){var i,n,r,l=this,a=e.querySelectorAll(t);if(a.length)for(i=l.element,n=0;r=a[n];n++)if(r===i)return!0;return l.getParent(t)}function s(){for(var t,e,i,n,l,a=this,o=a.getChildren('[itemprop="contentUrl"]'),c=[],s=0;t=o[s];s++)e=(e=t.getAttribute("width"))?parseInt(e):null,i=(i=t.getAttribute("height"))?parseInt(i):null,n=e&&i?i/e:null,l=(l=t.getAttribute("media"))?new r(l).on("match unmatch",function(){u.call(a)}):null,c.push({url:t.getAttribute("content"),ratio:n,quality:t.getAttribute("quality"),mql:l,selector:t.getAttribute("selector")});return c}function d(t){var e=this,i=e.getParent(),n=p[e.uuid];return n.container.setStyle("paddingBottom",100*(t||n.ratio||i.offsetHeight/i.offsetWidth)+"%"),e}function g(t,e){var r,a,o,c,g,A,b,v=n.prototype.constructor.call(this,t,e),w=v.uuid;return a=new i("<div />").setStyles({position:"relative",display:"block",width:"100%",height:0,padding:0}).appendTo(v),o=(r=v.getChildren('[itemprop="width"]')[0])?parseInt(r.getAttribute("content")):null,c=(r=v.getChildren('[itemprop="height"]')[0])?parseInt(r.getAttribute("content")):null,g=(r=v.getChildren('[itemprop="quality"]')[0])?parseInt(r.getAttribute("content")):null,A=(r=v.getChildren('[itemprop="caption"]')[0])?r.getAttribute("content"):null,b=p[w]={visible:!1,settings:l({},h.settings,e),ratio:o&&c?c/o:null,quality:g,container:a,image:new i("<img />",{src:m,alt:A||""},{position:"absolute",display:"block",width:"100%",height:"100%",top:"0",left:"0",margin:"0",padding:"0"}).appendTo(a),candidates:s.call(v),caption:A},f.push(v),d.call(v).on("appear disappear",function(t){b.visible="appear"===t.type,u.call(v)})}var h,p={},f=[],A=/(.+?).(jpe?g|png|gif)$/,m="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=";return new i(t).on("resize orientationchange",a(o)),h=n.extend(g),h.settings={modifier:function(t){return t.scale=Math.min(200,t.scale),t}},h}n(["/nucleus/dom/element","/nucleus/dom/element/appear","/nucleus/component/sense","/nucleus/function/merge","/nucleus/function/debounce"],r)}(this,document,demand,provide);
//# sourceMappingURL=main.js.map
