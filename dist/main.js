/*! /main 1.0.6 | https://github.com/dlueth/qoopido.rescale | (c) 2016 Dirk Lueth */
!function(t,e,i,n){"use strict";function l(i,n,l,r,a){function o(){for(var t,e=0;t=f[e];e++)u.call(t)}function u(){for(var e,i,n,l,r,a,o=this,u=p[o.uuid],c=o.getParent(),h=0;e=u.candidates[h];h++)if((!e.mql||e.mql.matches)&&(!e.selector||s.call(o,e.selector)))return i=u.image,u.visible&&(n=i.element.getBoundingClientRect(),l=u.settings.modifier({width:n.width,height:n.width*(e.ratio||u.ratio||c.offsetHeight/c.offsetWidth),scale:100*(t.devicePixelRatio||1)}),r=e.quality||u.quality,a=e.url.replace(A,"$1."+Math.round(l.width)+"x"+Math.round(l.height)+"@"+Math.round(l.scale)+(r?"."+r:"")+".$2"),i.setStyle("visibility","hidden").one("load",function(){i.setStyle("visibility","visible").emit("rescale",e.url,a)}).setAttribute("src",a)),void d.call(o,e.ratio);d.call(o)}function s(t){var i,n,l,r=this,a=e.querySelectorAll(t);if(a.length)for(i=r.element,n=0;l=a[n];n++)if(l===i)return!0;return r.getParent(t)}function c(){for(var t,e,i,n,r,a=this,o=a.getChildren('[itemprop="contentUrl"]'),s=[],c=0;t=o[c];c++)e=(e=t.getAttribute("width"))?parseInt(e):null,i=(i=t.getAttribute("height"))?parseInt(i):null,n=e&&i?i/e:null,r=(r=t.getAttribute("media"))?new l(r).on("match unmatch",function(){u.call(a)}):null,s.push({url:t.getAttribute("content"),ratio:n,quality:t.getAttribute("quality"),mql:r,selector:t.getAttribute("selector")});return s}function d(t){var e=this,i=e.getParent(),n=p[e.uuid];return n.container.setStyle("paddingBottom",100*(t||n.ratio||i.offsetHeight/i.offsetWidth)+"%"),e}function h(t,e){var l,a,o,s,h,A,b,v=n.prototype.constructor.call(this,t,e),y=v.uuid;return a=new i("<div />").setStyles({position:"relative",display:"block",width:"100%",height:0,padding:0}).appendTo(v),o=(l=v.getChildren('[itemprop="width"]')[0])?parseInt(l.getAttribute("content")):null,s=(l=v.getChildren('[itemprop="height"]')[0])?parseInt(l.getAttribute("content")):null,h=(l=v.getChildren('[itemprop="quality"]')[0])?parseInt(l.getAttribute("content")):null,A=(l=v.getChildren('[itemprop="caption"]')[0])?l.getAttribute("content"):null,b=p[y]={visible:!1,settings:r({},g.settings,e),ratio:o&&s?s/o:null,quality:h,container:a,image:new i("<img />",{src:m,alt:A||""},{position:"absolute",display:"block",width:"100%",height:"100%",top:"0",left:"0",margin:"0",padding:"0"}).appendTo(a),candidates:c.call(v),caption:A},f.push(v),d.call(v).on("appear disappear",function(t){b.visible="appear"===t.type,u.call(v)})}var g,p={},f=[],A=/(.+?).(jpe?g|png|gif)$/,m="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=";return new i(t).on("resize orientationchange",a(o)),g=n.extend(h),g.settings={modifier:function(t){return t.scale=Math.min(200,t.scale),t}},g}n(["/nucleus/dom/element","/nucleus/dom/element/appear","/nucleus/component/sense","/nucleus/function/merge","/nucleus/function/debounce"],l)}(this,document,demand,provide);
//# sourceMappingURL=main.js.map
