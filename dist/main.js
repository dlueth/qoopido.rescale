/*! /main 2.0.0 | https://github.com/dlueth/qoopido.rescale | (c) 2016 Dirk Lueth */
!function(t,e,i,n){"use strict";function r(i,n,r,l,a){function o(){for(var t,e=0;t=f[e];e++)u.call(t)}function u(){for(var e,i,n,r,l,a,o=this,u=h[o.uuid],s=o.getParent(),p=0;e=u.candidates[p];p++)if((!e.mql||e.mql.matches)&&(!e.selector||c.call(o,e.selector)))return i=u.image,u.visible&&(n=i.node.getBoundingClientRect(),r=u.settings.modifier({width:n.width,height:n.width*(e.ratio||u.ratio||s.offsetHeight/s.offsetWidth),scale:100*(t.devicePixelRatio||1)}),l=e.quality||u.quality,a=e.url.replace(A,"$1."+Math.round(r.width)+"x"+Math.round(r.height)+"@"+Math.round(r.scale)+(l?"."+l:"")+".$2"),i.setAttribute("src",a).emit("rescale",e.url,a)),void d.call(o,e.ratio);d.call(o)}function c(t){var i,n,r,l=this,a=e.querySelectorAll(t);if(a.length)for(i=l.node,n=0;r=a[n];n++)if(r===i)return!0;return l.getParent(t)}function s(){for(var t,e,i,n,l,a=this,o=a.getChildren('[itemprop="contentUrl"]'),c=[],s=0;t=o[s];s++)e=(e=t.getAttribute("width"))?parseInt(e):null,i=(i=t.getAttribute("height"))?parseInt(i):null,n=e&&i?i/e:null,l=(l=t.getAttribute("media"))?new r(l).on("match unmatch",function(){u.call(a)}):null,c.push({url:t.getAttribute("content"),ratio:n,quality:t.getAttribute("quality"),mql:l,selector:t.getAttribute("selector")});return c}function d(t){var e=this,i=h[e.uuid],n=i.parent;return i.container.setStyle("paddingBottom",100*(t||i.ratio||n.offsetHeight/n.offsetWidth)+"%"),e}function p(t,e){var r,a,o,c,p,A,b,v,w=n.prototype.constructor.call(this,t,e),y=w.uuid;for(a=w.getParent(),o=new i("<div />").setStyles({position:"relative",display:"block",width:"100%",height:0,padding:0}).appendTo(w),c=(r=w.getChildren('[itemprop="width"]')[0])?parseInt(r.getAttribute("content")):null,p=(r=w.getChildren('[itemprop="height"]')[0])?parseInt(r.getAttribute("content")):null,A=(r=w.getChildren('[itemprop="quality"]')[0])?parseInt(r.getAttribute("content")):null,b=(r=w.getChildren('[itemprop="caption"]')[0])?r.getAttribute("content"):null;0===a.offsetHeight;)a=a.parentNode;return v=h[y]={visible:!1,settings:l({},g.settings,e),ratio:c&&p?p/c:null,quality:A,parent:a,container:o,image:new i("<img />",{src:m,alt:b||""},{position:"absolute",display:"block",width:"100%",height:"100%",top:"0",left:"0",margin:"0",padding:"0"}).appendTo(o),candidates:s.call(w),caption:b},f.push(w),d.call(w).on("appear disappear",function(t){v.visible="appear"===t.type,u.call(w)})}var g,h={},f=[],A=/(.+?).(jpe?g|png|gif)$/,m="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=";return new i(t).on("resize orientationchange",a(o)),g=n.extend(p),g.settings={modifier:function(t){return t.scale=Math.min(200,t.scale),t}},g}n(["/nucleus/dom/element","/nucleus/dom/element/appear","/nucleus/component/sense","/nucleus/function/merge","/nucleus/function/debounce"],r)}(this,document,demand,provide);
//# sourceMappingURL=main.js.map
